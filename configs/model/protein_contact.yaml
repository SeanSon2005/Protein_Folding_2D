_target_: src.models.protein_module.ProteinContactModule

optimizer:
  _target_: torch.optim.Adam
  _partial_: true
  lr: 0.0003
  weight_decay: 8e-4

# Cosine Anneal with Warmup
scheduler:
  target_class: src.models.components.lr_schedulers.WarmupCosineLR
  warmup_ratio: 0.1
  eta_min: 1e-6
  interval: step
  frequency: 1
  monitor: null
  requires_total_steps: true

net:
  _target_: src.models.components.esm_fold_contact_net.ESMFoldContactNet
  input_dim: 5120
  projection_dim: 512
  model_dim: 512
  num_layers: 4
  dropout: 0.2
  pair_dim: 16
  pair_mlp_dim: 32
  sequence_head_width: 16
  pairwise_head_width: 8
  relative_distance_bins: 32  # clip [-32, 32], plus far bucket
  max_recycles: 1
  chunk_size: 8
  num_classes: ${..num_classes}

# DSSP8 has 9 structural states + padding index 0
num_classes: 10

# compile model for faster training with pytorch 2.0
compile: false
